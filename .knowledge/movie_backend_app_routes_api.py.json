{"is_source_file": true, "format": "Python", "description": "This is a Flask-based Python source file defining API endpoints for a movie application. It provides routes for fetching saved movies, registering attendance, adding favorites, and listing user favorites, all integrated with a Supabase backend.", "external_files": ["flask", "flask_smorest", "flask.views", "datetime", "typing", "...supabase_client"], "external_methods": ["get_supabase"], "published": ["blp"], "classes": [{"name": "Movies", "description": "Handles the retrieval of saved movies from the Supabase database."}, {"name": "Register", "description": "Handles creating attendance records in the Supabase 'attendance' table."}, {"name": "FavoritesCreate", "description": "Handles adding a favorite movie record into the 'favorites' table."}, {"name": "FavoritesList", "description": "Handles listing of favorite movies for a specific user."}], "methods": [{"name": "_json_error(message: str, status: int = 400, details: Optional[dict] = None)", "description": "Constructs an error response payload with a message, optional details, and status code.", "scope": "", "scopeKind": ""}, {"name": "str _now_iso()", "description": "Returns the current UTC datetime in ISO 8601 format.", "scope": "", "scopeKind": ""}, {"name": "Tuple[Any,Optional[Tuple[dict,int]]] _require_supabase()", "description": "Ensures the Supabase client is available; returns it or an error response.", "scope": "", "scopeKind": ""}, {"name": "Tuple[Optional[Dict[str,Any]],Optional[Tuple[dict,int]]] _validate_json(required_fields: List[str])", "description": "Validates that the incoming request has JSON payload with required fields.", "scope": "", "scopeKind": ""}, {"name": "get(self)", "description": "Fetches saved movies with pagination, handling database errors gracefully (in Movies class).", "scope": "Movies", "scopeKind": "class"}, {"name": "post(self)", "description": "Creates an attendance record, validating input and handling errors (in Register class).", "scope": "Register", "scopeKind": "class"}, {"name": "post", "description": "Adds a favorite movie record into the database with validation (in FavoritesCreate class)."}, {"name": "get(self, user_id: str)", "description": "Retrieves the list of favorites for a given user_id, ordered by creation date (in FavoritesList class).", "scope": "FavoritesList", "scopeKind": "class"}], "calls": ["get_supabase", "client.table", "select", "insert", "execute", "range", "count", "order", "eq"], "search-terms": ["Flask", "Supabase API", "Movie backend", "favorites endpoint", "attendance registration", "movies fetch", "api routes", "Python Flask API"], "state": 2, "file_id": 9, "knowledge_revision": 44, "git_revision": "7dcb2a2210757330f37d4657f7418c2d8912d3da", "revision_history": [{"23": ""}, {"44": "7dcb2a2210757330f37d4657f7418c2d8912d3da"}], "ctags": [{"_type": "tag", "name": "FavoritesCreate", "path": "/home/kavia/workspace/code-generation/cinema-explorer-178463-178472/movie_backend/app/routes/api.py", "pattern": "/^class FavoritesCreate(MethodView):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "FavoritesList", "path": "/home/kavia/workspace/code-generation/cinema-explorer-178463-178472/movie_backend/app/routes/api.py", "pattern": "/^class FavoritesList(MethodView):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "Movies", "path": "/home/kavia/workspace/code-generation/cinema-explorer-178463-178472/movie_backend/app/routes/api.py", "pattern": "/^class Movies(MethodView):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "Register", "path": "/home/kavia/workspace/code-generation/cinema-explorer-178463-178472/movie_backend/app/routes/api.py", "pattern": "/^class Register(MethodView):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "_json_error", "path": "/home/kavia/workspace/code-generation/cinema-explorer-178463-178472/movie_backend/app/routes/api.py", "pattern": "/^def _json_error(message: str, status: int = 400, details: Optional[dict] = None):$/", "language": "Python", "kind": "function", "signature": "(message: str, status: int = 400, details: Optional[dict] = None)"}, {"_type": "tag", "name": "_now_iso", "path": "/home/kavia/workspace/code-generation/cinema-explorer-178463-178472/movie_backend/app/routes/api.py", "pattern": "/^def _now_iso() -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "_require_supabase", "path": "/home/kavia/workspace/code-generation/cinema-explorer-178463-178472/movie_backend/app/routes/api.py", "pattern": "/^def _require_supabase() -> Tuple[Any, Optional[Tuple[dict, int]]]:$/", "language": "Python", "typeref": "typename:Tuple[Any,Optional[Tuple[dict,int]]]", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "_validate_json", "path": "/home/kavia/workspace/code-generation/cinema-explorer-178463-178472/movie_backend/app/routes/api.py", "pattern": "/^def _validate_json(required_fields: List[str]) -> Tuple[Optional[Dict[str, Any]], Optional[Tuple/", "language": "Python", "typeref": "typename:Tuple[Optional[Dict[str,Any]],Optional[Tuple[dict,int]]]", "kind": "function", "signature": "(required_fields: List[str])"}, {"_type": "tag", "name": "blp", "path": "/home/kavia/workspace/code-generation/cinema-explorer-178463-178472/movie_backend/app/routes/api.py", "pattern": "/^blp = Blueprint($/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "get", "path": "/home/kavia/workspace/code-generation/cinema-explorer-178463-178472/movie_backend/app/routes/api.py", "pattern": "/^    def get(self):$/", "language": "Python", "kind": "member", "signature": "(self)", "scope": "Movies", "scopeKind": "class"}, {"_type": "tag", "name": "get", "path": "/home/kavia/workspace/code-generation/cinema-explorer-178463-178472/movie_backend/app/routes/api.py", "pattern": "/^    def get(self, user_id: str):$/", "language": "Python", "kind": "member", "signature": "(self, user_id: str)", "scope": "FavoritesList", "scopeKind": "class"}, {"_type": "tag", "name": "post", "path": "/home/kavia/workspace/code-generation/cinema-explorer-178463-178472/movie_backend/app/routes/api.py", "pattern": "/^    def post(self):$/", "language": "Python", "kind": "member", "signature": "(self)", "scope": "FavoritesCreate", "scopeKind": "class"}, {"_type": "tag", "name": "post", "path": "/home/kavia/workspace/code-generation/cinema-explorer-178463-178472/movie_backend/app/routes/api.py", "pattern": "/^    def post(self):$/", "language": "Python", "kind": "member", "signature": "(self)", "scope": "Register", "scopeKind": "class"}], "hash": "f184610d5494570f38026eac11e7149a", "format-version": 4, "code-base-name": "movie_backend", "filename": "movie_backend/app/routes/api.py", "fields": [{"name": "blp = Blueprint(", "scope": "", "scopeKind": "", "description": "unavailable"}]}